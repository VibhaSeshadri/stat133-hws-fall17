---
title: "hw02-vibha-seshadri"
author: "Vibha Seshadri"
date: "September 29, 2017"
output: github_document
---

```{r warning=FALSE, message=FALSE}
# load packages
library(ggplot2)
library(readr)
library(dplyr)
```

####Importing the data in R
- Loading data using `read.csv()`
```{r base}
dat1 <- read.csv('../data/nba2017-player-statistics.csv', 
                 stringsAsFactors = FALSE,
                 colClasses = c("character", "character", "factor", "character", 
                                "double", rep("integer", 19))
              )
str(dat1)
```

- Loading data using `read_csv()`
```{r readr}
dat2 <- read_csv('../data/nba2017-player-statistics.csv', col_types = list(
                   Player = col_character(),
                   Team = col_character(),
                   Position = col_factor(c("C", "PF", "PG", "SF", "SG")),
                   Experience = col_character(),
                   Salary = col_double(),
                   Rank = col_integer(),
                   Age = col_integer(),
                   GP = col_integer(),
                   GS = col_integer(),
                   MIN = col_integer(),
                   FGM = col_integer(),
                   FGA = col_integer(),
                   Points3 = col_integer(),
                   Points3_atts = col_integer(),
                   Points2 = col_integer(),
                   Points2_atts = col_integer(),
                   FTM = col_integer(),
                   FTA = col_integer(),
                   OREB = col_integer(),
                   DREB = col_integer(),
                   AST = col_integer(),
                   STL = col_integer(),
                   BLK = col_integer(),
                   TO = col_integer()
                   )
                 )
                  
str(dat2)
```

#### Right after importing the data
- Coercing `Experience` to be an integer vector
```{r coerceExperience}
dat1$Experience[dat1$Experience == "R"] <- "0"
dat1$Experience <- as.integer(dat1$Experience)
```

#### Performance of players
```{r EFF}
# Adding EFF Column
dat1 <- mutate(dat1, "Missed_FG" = FGA - FGM, "Missed_FT" = FTA - FTM, "PTS" = Points2*2 + Points3*3 + FTM, REB = OREB + DREB, "MPG" = MIN/GP) 
dat1 <- mutate(dat1, "EFF" = (PTS + REB + AST + STL + BLK - Missed_FG - Missed_FT - TO) / GP)
summary(dat1$EFF)

# Making histogram
hist(dat1$EFF, xlab = "EFF", ylab = "Frequency", main = "Histogram of Efficiency (EFF)")

# Displaying player name, team, salary, and EFF value of the top-10 players in decreasing order
slice(arrange(select(dat1, Player, Team, Salary, EFF), desc(EFF)), 1:10)

# Names of players that have negative EFF
select(filter(dat1, EFF < 0), Player)

# Using cor() to compute the correlation coefficients between EFF and all the variables used in the EFF formula

PTS_cor <- cor(dat1$PTS, dat1$EFF)
REB_cor <- cor(dat1$REB, dat1$EFF)
AST_cor <- cor(dat1$AST, dat1$EFF)
STL_cor <- cor(dat1$STL, dat1$EFF)
BLK_cor <- cor(dat1$BLK, dat1$EFF)
Missed_FG_cor <- cor(dat1$Missed_FG, dat1$EFF) * -1
Missed_FT_cor <- cor(dat1$Missed_FT, dat1$EFF) * -1 
TO_cor <- cor(dat1$TO, dat1$EFF) * -1
core_data_frame <- data.frame(
  correlations = c('Points', 'Rebounds', 'Assists', 'Steal', 'Block', 'Missed_FG', 'Missed_FT', 'Turnover'),
  values = c(PTS_cor, REB_cor, AST_cor, STL_cor, BLK_cor, Missed_FG_cor, Missed_FT_cor, TO_cor)
)
core_data_frame <- arrange(core_data_frame, desc(core_data_frame$values))
barplot(core_data_frame$values, names.arg = core_data_frame$correlations, main = "Correlation Between Player Stats and EFF", width = 1, xlim = c(0,10), cex.names = 0.5, ylim = c(-1, 1))
```

#### Effeciency and Salary
```{r eff&sal}
# Creating scatterplot of data frame, dat1, between Efficiency and Salary
ggplot(data = dat1, aes(x = EFF, y = Salary), xlab = Efficiency, ylab = Salary) +
  geom_point() +
  geom_smooth(method = loess)

# Linear Correlation Coefficient between Salary and Efficiency
cor(dat1$EFF, dat1$Salary)

# Taking a look at more established players and their salaries
players2 <- filter(dat1, MPG >= 20)
```

Since the linear correlation coefficient, `r cor(dat1$EFF, dat1$Salary)`, between `Efficiency` and `Salary` for all NBA players is positive, and the data points in the scatterplot are grouped close to each other, there seems to be a positive relationship between a player's `Efficiency` and `Salary`. 

```{r players2eff&sal}
# Creating scatterplot of data frame, players2, between Efficiency and Salary
ggplot(data = players2, aes(x = EFF, y = Salary), xlab = Efficiency, ylab = Salary) +
  geom_point() +
  geom_smooth(method = loess)

# Linear Correlation Coefficient between Salary and Efficiency
cor(players2$EFF, players2$Salary)
```

The linear correlation coefficient, `r cor(players2$EFF, players2$Salary)`, between `Efficiency` and `Salary` for more established NBA players is positive but less than the linear correlation coefficient between `Efficiency` and `Salary` of all NBA players.